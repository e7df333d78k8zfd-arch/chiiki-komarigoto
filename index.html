<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>地域の困りごと投稿</title>

<style>
body {
  font-family: sans-serif;
  background: #f2f2f2;
  margin: 0;
  padding: 16px;
}

h1 {
  text-align: center;
}

input, select, textarea, button {
  width: 100%;
  margin-bottom: 12px;
  padding: 8px;
  font-size: 16px;
}

button {
  background: #4f46e5;
  color: white;
  border: none;
  border-radius: 6px;
}
</style>
</head>
<body>

<h1>地域の困りごと投稿</h1>

<input id="title" placeholder="タイトル">

<input id="location" placeholder="地域・場所（例：○○町）">

<select id="category">
  <option value="高齢者">高齢者</option>
  <option value="子育て">子育て</option>
  <option value="障害">障害</option>
  <option value="生活困窮">生活困窮</option>
</select>

<textarea id="content" rows="5" placeholder="困っている内容"></textarea>

<button id="submitBtn">投稿</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCuA1iGo0nHN7w4tuv6LaQ34I41Yp0EXbE",
  authDomain: "chiiki-komarigoto.firebaseapp.com",
  projectId: "chiiki-komarigoto",
  storageBucket: "chiiki-komarigoto.firebasestorage.app",
  messagingSenderId: "278691153990",
  appId: "1:278691153990:web:3dbc7a67c2959a9a726247"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

document.getElementById("submitBtn").addEventListener("click", async () => {
  const title = document.getElementById("title").value.trim();
  const location = document.getElementById("location").value.trim();
  const category = document.getElementById("category").value;
  const content = document.getElementById("content").value.trim();

  if (!title || !location || !content) {
    alert("未入力の項目があります");
    return;
  }

  try {
    await addDoc(collection(db, "issues"), {
      title,
      location,
      category,
      content,
      createdAt: serverTimestamp()
    });

    alert("投稿しました！");
    document.getElementById("title").value = "";
    document.getElementById("location").value = "";
    document.getElementById("content").value = "";

  } catch (e) {
    alert("エラー：" + e.message);
  }
});
</script>

</body>
</html>
